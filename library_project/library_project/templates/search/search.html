{% extends 'base.html' %}
{% block head %}

{%endblock%}
{% block title %}eLib - Search Results{% endblock %}

{% block body %}
    {% include 'search/searchbar.html' %}
    <div class="container">
        <pre> {{SQLquery.0}} </pre>
    {% if results %}

    <p> Showing results <strong id="resultsNumbers">{{ num_res.0 }}-{{ num_res.1}} </strong></p>

        <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Publisher</th>
                </tr>
            </thead>
            <tbody>
                {% for result in results %}
                    <tr>
                        <td><a href="{% url 'book-details' result.0 %}">{{ result.1 }}</a></td>  <!-- Title -->
                        <td>{{ result.2 }}</td>  <!-- publisher -->
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p id="noResults">No results found.</p>
    {% endif %}
    <button id="previousButton" type="button" onclick="previousPage()">Previous</button>
    <button id="nextButton" type="button" onclick="nextPage()">Next</button>
    <script>
        const queryString = window.location.search
        const urlParams = new URLSearchParams(queryString);
        const pageNum = parseInt(urlParams.get("page"));
        function previousPage() {
            pageField.value = Math.max(pageNum - 1, 1);
            document.getElementById('searchForm').submit();
        }

        function nextPage() {
            pageField.value = pageNum + 1;
            document.getElementById('searchForm').submit();
        }
        const pageField = document.getElementById('id_page');
        if (pageField.value == 1) {
            document.getElementById('previousButton').disabled = true;
        }
        const [lower, upper] = document.getElementById('resultsNumbers').innerText.split("-");
        if (parseInt(upper)-parseInt(lower) < 50 || document.getElementById("noResults") != null) {
            document.getElementById('nextButton').disabled = true;
        }


    </script>
    </div>

{% endblock %}
